{% load static %}
<!DOCTYPE html>
<html>
<head>
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-CZVF59PMPJ"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-CZVF59PMPJ');
    </script>
    
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Happy Third Aniversary!</title>
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Parisienne&display=swap" rel="stylesheet">
    <script>
        // Define all static paths once
        const STATIC_URL = "{% static '' %}";
        const GAME_ASSETS = {
            dino: "{% static 'love_site/images/game-assets/img/dino.png' %}",
            cactus1: "{% static 'love_site/images/game-assets/img/cactus1.png' %}",
            cactus2: "{% static 'love_site/images/game-assets/img/cactus2.png' %}",
            cactus3: "{% static 'love_site/images/game-assets/img/cactus3.png' %}"
        };
        const HEADS = {
            partner: "{% static 'love_site/images/heads/partner-head.png' %}",
            you: "{% static 'love_site/images/heads/you-head.png' %}"
        };
        const BACKGROUND_PATHS = {
            set1: [
                "{% static 'love_site/images/backgrounds/1.jpg' %}",
                "{% static 'love_site/images/backgrounds/2.jpg' %}",
                "{% static 'love_site/images/backgrounds/3.jpg' %}",
                "{% static 'love_site/images/backgrounds/4.jpg' %}"
            ],
            set2: [
                "{% static 'love_site/images/backgrounds/5.jpg' %}",
                "{% static 'love_site/images/backgrounds/6.jpg' %}",
                "{% static 'love_site/images/backgrounds/7.jpg' %}",
                "{% static 'love_site/images/backgrounds/8.jpg' %}"
            ],
            set3: [
                "{% static 'love_site/images/backgrounds/9.jpg' %}",
                "{% static 'love_site/images/backgrounds/10.jpg' %}",
                "{% static 'love_site/images/backgrounds/11.jpg' %}",
                "{% static 'love_site/images/backgrounds/12.jpg' %}"
            ]
        };
    </script>
</head>
<body>
    <div class="background-columns">
        <!-- First Set -->
        <div class="photo-column set-1" style="background-image: url({% static 'love_site/images/backgrounds/1.jpg' %});"></div>
        <div class="photo-column set-1" style="background-image: url({% static 'love_site/images/backgrounds/2.jpg' %});"></div>
        <div class="photo-column set-1" style="background-image: url({% static 'love_site/images/backgrounds/3.jpg' %});"></div>
        <div class="photo-column set-1" style="background-image: url({% static 'love_site/images/backgrounds/4.jpg' %});"></div>
        
        <!-- Second Set -->
        <div class="photo-column set-2" style="background-image: url({% static 'love_site/images/backgrounds/5.jpg' %});"></div>
        <div class="photo-column set-2" style="background-image: url({% static 'love_site/images/backgrounds/6.jpg' %});"></div>
        <div class="photo-column set-2" style="background-image: url({% static 'love_site/images/backgrounds/7.jpg' %});"></div>
        <div class="photo-column set-2" style="background-image: url({% static 'love_site/images/backgrounds/8.jpg' %});"></div>
        
        <!-- Third Set -->
        <div class="photo-column set-3" style="background-image: url({% static 'love_site/images/backgrounds/9.jpg' %});"></div>
        <div class="photo-column set-3" style="background-image: url({% static 'love_site/images/backgrounds/10.jpg' %});"></div>
        <div class="photo-column set-3" style="background-image: url({% static 'love_site/images/backgrounds/11.jpg' %});"></div>
        <div class="photo-column set-3" style="background-image: url({% static 'love_site/images/backgrounds/12.jpg' %});"></div>
    </div>
    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Load all sets of images
            const loadImages = (set, paths) => {
                paths.forEach((path, index) => {
                    const img = new Image();
                    img.src = path;
                    img.onerror = () => {
                        console.error(`Failed to load image from set ${set}: ${path}`);
                    };
                    img.onload = () => {
                        console.log(`Successfully loaded image from set ${set}: ${path}`);
                    };
                });
            };

            // Load all three sets
            loadImages('set1', BACKGROUND_PATHS.set1);
            loadImages('set2', BACKGROUND_PATHS.set2);
            loadImages('set3', BACKGROUND_PATHS.set3);
        });
    </script>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const img = document.querySelector('.test-image');
        if (img) {
            img.onload = () => {
                document.getElementById('image-status').textContent = "Loaded successfully!";
                console.log('Image dimensions:', img.naturalWidth + 'x' + img.naturalHeight);
            };
            img.onerror = () => {
                document.getElementById('image-status').textContent = "Failed to load!";
            };
        }
    });
    </script>
    <h1 class="title">Happy Anniversary My Darling</h1>

    <div class="letter-container">
        <div class="envelope" onclick="toggleLetter()">
            <div class="wax-seal"></div>
        </div>
            <div class="letter-content">
                <div class="handwritten-text">
                    <p>Happy Anniversary Vritti,</p>
                    
                    <p>I know things aren't certain between us right now but regardless I wouldn't trade these 3 years for anything. Thank you so much for being the best girlfriend and teaching me what it is like to love someone and what it is like to be loved by someone.</p>
                
                    <p>I am really happy about how we left things and I just want to keep working to get back to feeling like us. I know this week we shared can't erase everything that we have been through but it really made me realize how much I care about you and how much I just want to make you smile everyday. I'm so sorry our relationship recently has been so heavy and tense and I'm so sorry that it got to that point in the first place.</p>
                
                    <p>I love you so much my darling and thank you for helping me grow and mature into who I am today. Don't worry even tho this letter wasn't as long, I still made you some games. I made you your own word game lmao. It's kinda like hangman but u get a theme and three words related to the theme and u guess them by picking letters 1 by 1. There's also an unlimited Wordle and a mini golf game. I know the last games weren't that good so I wanted to make some games you might actually play. Hope you enjoy and I love you so much and thank you for the last 3 years my darling.</p>
                    
                    <p style="text-align: right; margin-top: 2rem;">
                        - Liam<br>
                        <span style="font-size: 0.8em;">❤</span>
                    </p>
                </div>
            </div>
    </div>

    <div class="activities">
        <div class="activity" onclick="window.startTrivia(); return false;">Relationship Trivia</div>
        <div class="activity" onclick="window.startGame(); return false;">Liam Escape</div>
        <div class="activity" onclick="window.openVideo(); return false;">Liam and Vritti</div>
        <div class="activity" onclick="window.openWordGame(); return false;">Word Game</div>
        <div class="activity" onclick="window.openWordle(); return false;">Wordle</div>
        <div class="activity" onclick="window.openGolf()">Golf Game</div>
    </div>
    
    <!-- Game container for "Catch Me Game" -->
    <div class="game-container" style="display: none;">
        <canvas id="board"></canvas>
        <div id="game-over" style="display: none;">
            <h2>Caught You!</h2>
            <button onclick="startGame()">Play Again</button>
        </div>
    </div>

    <!-- VIDEO POPUP -->
    <div id="video-popup" class="popup" style="display: none; z-index: 2000;">
        <div class="popup-content video-content">
            <button class="close-button" onclick="closeVideo()">✕</button>
            <div class="video-container">
                <video id="couple-video" controls>
                    <source src="{% static 'love_site/videos/couple.mov' %}" type="video/quicktime">
                    <source src="{% static 'love_site/videos/couple.mov' %}" type="video/mp4">
                    Your browser does not support the video tag.
                </video>
            </div>
        </div>
    </div>

    <!-- TRIVIA POPUP -->
    <div id="trivia-popup" class="popup" style="display: none; z-index: 2000;">
        <div class="popup-content">
            <button class="close-button" onclick="closeTrivia()">✕</button>
            <div id="trivia-container">
                <div class="trivia-score">Score: <span id="trivia-score">0</span></div>
                <div class="trivia-question"></div>
                <div class="trivia-choices"></div>
                <div id="trivia-message" class="hidden">❤ Great job! Keep going! ❤</div>
            </div>
        </div>
    </div>

    <!-- Word Game Popup -->
    <div id="word-game-popup" class="popup" style="display: none; z-index: 2000;">
        <div class="popup-content">
            <button class="close-button" onclick="closeWordGame()">✕</button>
            <canvas id="gameCanvas" width="800" height="600"></canvas>
        </div>
    </div>

    <!-- Wordle Game Popup -->
    <div id="wordle-popup" class="popup" style="display: none; z-index: 2000;">
        <div class="popup-content">
            <button class="close-button" onclick="closeWordle()">✕</button>
            <div id="container">
                <div id="grid">
                    <div class="row">
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                    </div>
                    <div class="row">
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                    </div>
                    <div class="row">
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                    </div>
                    <div class="row">
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                    </div>
                    <div class="row">
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                    </div>
                    <div class="row">
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                        <div class="cell"></div>
                    </div>
                </div>
                <div id="message"></div>
            </div>
        </div>
    </div>

    <!-- Golf Game Popup -->
    <div id="golf-popup" class="popup" style="display: none; z-index: 2000;">
        <div class="popup-content">
            <button class="close-button" onclick="window.closeGolf()">✕</button>
            <canvas id="golfCanvas" width="800" height="600"></canvas>
        </div>
    </div>

    <style>
    /* Full screen popup overlay */
    .popup {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(255, 240, 245, 0.95);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
    }

    /* Close button styles */
    .close-button {
      position: absolute;
      top: 10px;
      right: 10px;
      background: #ff69b4;
      border: none;
      font-size: 20px;
      color: white;
      cursor: pointer;
      padding: 5px 10px;
    }

    /* Trivia Styles */
    .trivia-score {
        font-size: 24px;
        color: #ff69b4;
        text-align: center;
        margin: 20px 0;
        font-family: 'Dancing Script', cursive;
    }

    .trivia-question {
        font-size: 28px;
        color: #333;
        text-align: center;
        margin: 30px 0;
        padding: 20px;
        background: #fff0f5;
        border-radius: 10px;
        font-family: 'Dancing Script', cursive;
    }

    .trivia-choices {
        display: flex;
        flex-direction: column;
        gap: 15px;
        max-width: 600px;
        margin: 0 auto;
    }

    .trivia-choice {
        padding: 15px 20px;
        background: white;
        border: 2px solid #ff69b4;
        border-radius: 10px;
        cursor: pointer;
        transition: all 0.3s ease;
        font-size: 20px;
        font-family: 'Dancing Script', cursive;
        text-align: center;
    }

    .trivia-choice:hover {
        background: #fff0f5;
        transform: translateY(-2px);
    }

    .trivia-choice.correct {
        background: #90EE90;
        border-color: #228B22;
    }

    .trivia-choice.incorrect {
        background: #FFB6C1;
        border-color: #DC143C;
    }

    #trivia-message {
        text-align: center;
        color: #ff69b4;
        font-size: 24px;
        margin-top: 20px;
        font-family: 'Dancing Script', cursive;
    }

    #trivia-message.hidden {
        display: none;
    }

    /* Video popup styles */
    .video-content {
        padding: 30px;
        display: flex;
        justify-content: center;
        align-items: center;
        background: rgba(0, 0, 0, 0.9);
    }

    .video-container {
        width: 100%;
        max-width: 1080px;
        margin: 0 auto;
    }

    #couple-video {
        width: 100%;
        height: auto;
        max-height: 80vh;
        border-radius: 10px;
    }

    /* Wordle Game Styles */
    #container {
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 50px;
    }

    #grid {
        display: flex;
        flex-direction: column;
    }

    .row {
        display: flex;
    }

    .cell {
        width: 60px;
        height: 60px;
        margin: 5px;
        display: flex;
        justify-content: center;
        align-items: center;
        background-color: white;
        border: 2px solid #ff69b4;
        font-size: 24px;
        font-weight: bold;
        font-family: 'Arial', sans-serif;
    }

    .cell-green {
        background-color: #6aaa64;
        color: white;
        border-color: #6aaa64;
    }

    .cell-yellow {
        background-color: #c9b458;
        color: white;
        border-color: #c9b458;
    }

    .cell-gray {
        background-color: #787c7e;
        color: white;
        border-color: #787c7e;
    }

    #message {
        margin-top: 20px;
        font-size: 24px;
        text-align: center;
        font-family: 'Dancing Script', cursive;
        color: #ff69b4;
    }

    /* Golf Game Styles */
    #golfCanvas {
        background-color: #90EE90;
        border: 2px solid #ff69b4;
        border-radius: 10px;
    }
    </style>

    <!-- Move all script tags to the end of body and ensure proper order -->
    <script src="{% static 'js/script.js' %}?v=2"></script>
    <script src="{% static 'js/word_game.js' %}?v=1"></script>
    <script src="{% static 'js/wordle.js' %}?v=1"></script>
    <script src="{% static 'js/golf.js' %}?v=14"></script>
    <script>
        // Verify all game functions are loaded
        window.addEventListener('load', function() {
            console.log('Checking game functions...');
            if (typeof window.openGolf === 'function') {
                console.log('Golf game functions loaded successfully');
            } else {
                console.error('Golf game functions not loaded');
            }
        });
    </script>

</body>
</html>